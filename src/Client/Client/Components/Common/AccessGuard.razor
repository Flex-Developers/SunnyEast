@inject NavigationManager Nav
@inject AuthenticationStateProvider AuthProvider

<div class="access-denied-container">
    <div class="animated-background">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
        <div class="floating-shape shape-5"></div>
    </div>

    <MudContainer MaxWidth="MaxWidth.Small" Gutters="false" Class="mx-auto content-wrapper">
        <MudPaper Elevation="24" Class="access-denied-card">
            <div class="lock-icon-wrapper">
                <MudIcon Icon="@Icons.Material.Filled.Lock" Class="lock-icon" />
                <div class="pulse-ring"></div>
                <div class="pulse-ring delay-1"></div>
                <div class="pulse-ring delay-2"></div>
            </div>

            <MudText Typo="Typo.h3" Align="Align.Center" Class="error-code">403</MudText>
            
            <MudText Typo="Typo.h4" Align="Align.Center" Class="main-title">
                Упс! Доступ запрещён
            </MudText>
            
            <MudText Typo="Typo.body1" Align="Align.Center" Class="description">
                Похоже, у вас нет прав для просмотра этой страницы. 
                <br />
                Попробуйте войти в систему или вернитесь на главную.
            </MudText>

            <MudStack Row Justify="Justify.Center" Spacing="3" Class="action-buttons">
                @if (!_isAuth)
                {
                    <MudButton Variant="Variant.Filled" 
                               Color="Color.Primary" 
                               Size="Size.Large"
                               StartIcon="@Icons.Material.Filled.Login"
                               Class="login-button"
                               OnClick="Login">
                        Войти
                    </MudButton>
                }
                <MudButton Variant="Variant.Outlined" 
                           Color="Color.Default" 
                           Size="Size.Large"
                           StartIcon="@Icons.Material.Filled.Home"
                           Class="home-button"
                           OnClick="@(() => Nav.NavigateTo("/"))">
                    На главную
                </MudButton>
            </MudStack>

            <div class="decorative-line"></div>
            
            <MudText Typo="Typo.caption" Align="Align.Center" Class="hint-text">
                Если вы считаете, что это ошибка, обратитесь к администратору
            </MudText>
        </MudPaper>
    </MudContainer>
</div>

@code {
    private bool _isAuth;

    protected override async Task OnInitializedAsync()
    {
        var state = await AuthProvider.GetAuthenticationStateAsync();
        _isAuth = state.User.Identity?.IsAuthenticated == true;
    }

    private void Login()
    {
        var returnUrl = Uri.EscapeDataString(Nav.Uri);
        Nav.NavigateTo($"/login?returnUrl={returnUrl}");
    }
}

<style>
    .access-denied-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        /* Градиент по брендбуку: 70% #FF6600 → 30% #FFC000 */
        background: linear-gradient(135deg, #FF6600 0%, #FF6600 70%, #FFC000 100%);
    }

    .animated-background {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: 0;
    }

    .floating-shape {
        position: absolute;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        border-radius: 50%;
        animation: float 20s infinite ease-in-out;
    }

    .shape-1 {
        width: 80px;
        height: 80px;
        left: 10%;
        top: 20%;
        animation-delay: 0s;
    }

    .shape-2 {
        width: 120px;
        height: 120px;
        right: 15%;
        top: 50%;
        animation-delay: 2s;
    }

    .shape-3 {
        width: 60px;
        height: 60px;
        left: 70%;
        bottom: 20%;
        animation-delay: 4s;
    }

    .shape-4 {
        width: 90px;
        height: 90px;
        left: 20%;
        bottom: 30%;
        animation-delay: 6s;
    }

    .shape-5 {
        width: 150px;
        height: 150px;
        right: 5%;
        top: 10%;
        animation-delay: 8s;
    }

    @@keyframes float {
        0%, 100% {
            transform: translateY(0) rotate(0deg);
            opacity: 0.1;
        }
        50% {
            transform: translateY(-50px) rotate(180deg);
            opacity: 0.3;
        }
    }

    .content-wrapper {
        position: relative;
        z-index: 1;
        padding: 0;
    }

    .access-denied-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 48px 32px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.6s ease-out;
        max-width: 500px;
        margin: 0 auto;
    }

    @@keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .lock-icon-wrapper {
        position: relative;
        width: 120px;
        height: 120px;
        margin: 0 auto 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Оранжевый — основной брендовый */
    .lock-icon {
        font-size: 60px !important;
        color: #FF6600;
        z-index: 2;
        position: relative;
        animation: bounce 2s infinite;
    }

    @@keyframes bounce {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    /* Акцентные кольца — зелёный по брендбуку */
    .pulse-ring {
        position: absolute;
        width: 100%;
        height: 100%;
        border: 3px solid #019934;
        border-radius: 50%;
        opacity: 0;
        animation: pulse 3s infinite;
    }

    .pulse-ring.delay-1 {
        animation-delay: 1s;
    }

    .pulse-ring.delay-2 {
        animation-delay: 2s;
    }

    @@keyframes pulse {
        0% {
            transform: scale(0.6);
            opacity: 0.8;
        }
        100% {
            transform: scale(1.5);
            opacity: 0;
        }
    }

    /* Градиент цифры ошибки — основной (оранжевый → жёлтый) */
    .error-code {
        font-size: 72px !important;
        font-weight: 700 !important;
        background: linear-gradient(135deg, #FF6600 0%, #FFC000 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 8px !important;
        animation: glow 2s ease-in-out infinite alternate;
    }

    /* Свечение — оранжевый */
    @@keyframes glow {
        from {
            filter: drop-shadow(0 0 10px rgba(255, 102, 0, 0.5));
        }
        to {
            filter: drop-shadow(0 0 20px rgba(255, 102, 0, 0.8));
        }
    }

    .main-title {
        color: #2d3748;
        margin-bottom: 16px !important;
        font-weight: 600 !important;
    }

    .description {
        color: #4a5568;
        margin-bottom: 32px !important;
        line-height: 1.6 !important;
    }

    .action-buttons {
        margin-bottom: 32px !important;
    }

    /* Кнопка входа — основной градиент */
    .login-button {
        background: linear-gradient(135deg, #FF6600 0%, #FFC000 100%);
        color: #000000 !important; /* лучше читается на светлом градиенте */
        padding: 12px 32px !important;
        font-weight: 600 !important;
        transition: all 0.3s ease !important;
        border-radius: 50px !important;
    }

    .login-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(255, 102, 0, 0.3);
    }

    /* Вторая кнопка — акцентный зелёный */
    .home-button {
        border-color: #019934 !important;
        color: #019934 !important;
        padding: 12px 32px !important;
        font-weight: 600 !important;
        transition: all 0.3s ease !important;
        border-radius: 50px !important;
        border-width: 2px !important;
    }

    .home-button:hover {
        background-color: rgba(1, 153, 52, 0.1) !important;
        transform: translateY(-2px);
    }

    /* Декор — основной градиент */
    .decorative-line {
        width: 100px;
        height: 4px;
        background: linear-gradient(135deg, #FF6600 0%, #FFC000 100%);
        margin: 0 auto 24px;
        border-radius: 2px;
        opacity: 0.5;
    }

    .hint-text {
        color: #718096 !important;
        font-style: italic;
    }

    /* Адаптивность */
    @@media (max-width: 600px) {
        .access-denied-card {
            padding: 32px 20px;
        }

        .error-code {
            font-size: 56px !important;
        }

        .main-title {
            font-size: 24px !important;
        }

        .lock-icon-wrapper {
            width: 100px;
            height: 100px;
        }

        .lock-icon {
            font-size: 48px !important;
        }

        .action-buttons {
            flex-direction: column !important;
            width: 100%;
        }

        .login-button,
        .home-button {
            width: 100% !important;
            margin: 8px 0 !important;
        }

        .floating-shape {
            opacity: 0.05;
        }
    }

    @@media (max-width: 960px) {
        .access-denied-container {
            padding: 20px;
        }
    }

    /* Темная тема */
    .mud-theme-dark .access-denied-card {
        background: rgba(30, 30, 30, 0.95);
    }

    .mud-theme-dark .main-title {
        color: #e2e8f0;
    }

    .mud-theme-dark .description {
        color: #cbd5e0;
    }

    .mud-theme-dark .hint-text {
        color: #a0aec0 !important;
    }

</style>